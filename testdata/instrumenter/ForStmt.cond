package instrumenter

// https://go.dev/ref/spec#For_statements

// TODO: Add systematic tests.

// forStmt covers the instrumentation of [ast.ForStmt], which has the
// expression field Cond.
//
// In condition and branch coverage modes, the Cond field is instrumented.
func forStmt(a byte, b string) bool {

	// The condition of a ForStmt, if present, is always a boolean
	// expression and is therefore instrumented, no matter if it is a
	// simple or a complex expression.
	for i := 0; GobcoCover(0, i < len(b)) == true; i++ {
		if GobcoCover(1, b[i] == a) == true {
			return true
		}
	}

	// The condition of a ForStmt can be a single identifier.
	tooSmall := true
	for i := 0; GobcoCover(2, tooSmall == true) == true; i++ {
		tooSmall = GobcoCover(3, i < 5) == true
	}

	// The condition of a ForStmt can be a complex condition.
	bigEnough := false
	for i := 0; !(GobcoCover(4, bigEnough == true) == true); i++ {
		bigEnough = GobcoCover(5, i >= 5) == true
	}

	return false
}

// A ForStmt without condition can only have one outcome.
// Therefore no branch coverage is necessary.
func forever() {
	for {
		break
	}
}

// :16:14: "i < len(b)"
// :17:6: "b[i] == a"
// :24:14: "tooSmall"
// :25:14: "i < 5"
// :30:15: "bigEnough"
// :31:15: "i >= 5"
